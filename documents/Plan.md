# План автоматизации тестирования сервиса покупки туров через интернет-банк

## Перечень автоматизируемых сценариев

### UI-тесты

1. Успешная оплата валидной картой, со статусом APPROVED.
    
    Ожидаемый результат:
    * появляется сообщение о том, что операция одобрена банком;
    * в таблице payment_entity появляется запись, значение поля amount соответствует стоимости тура в копейках (4500000), поля status - APPROVED;
    * в таблице order_entity полявляется запись, значение поля payment_id соответствует значению поля transaction_id таблицы payment_entity.

2. Успешная выдача кредита на валидную карту, со статусом APPROVED.
    
    Ожидаемый результат:
    * появляется сообщение о том, что операция одобрена банком;
    * в таблице credit_request_entity появляется запись, значение поля status - APPROVED;
    * в таблице order_entity полявляется запись, значение поля payment_id соответствует значению поля bank_id таблицы credit_request_entity.

3. Отказ в оплате с карты, со статусом DECLINED.
    
    Ожидаемый результат:
    * появляется сообщение о том, что операция отклонена банком;
    * в таблице payment_entity появляется запись, значение поля amount соответствует стоимости тура в копейках (4500000), поля status - DECLINED;
    * в таблице order_entity не появляется записей.

4. Отказ в кредите по валидной карте, со статусом DECLINED.
    
    Ожидаемый результат:
    * появляется сообщение о том, что операция одобрена банком;
    * в таблице credit_request_entity появляется запись, значение поля status - DECLINED;
    * в таблице order_entity не появляется записей.

5. Негативные сценарии связанны с отправкой невалидных значений в полях формы:

    5.1. Поле *«Номер карты»*

    1) Отправка пустого поля.
    
        Ожидаемый результат: появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    2) Отправка слишком короткого номера карты.
    
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    3) Отправка номера карты банка, отсутствующего в БД.
    
        Ожидаемый результат: появляется уведомление об отказе в оплате банком, данные не отпавляются, записей в таблицах БД не создается.
    
    4) Отправка спец. символов.
    
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    5) Отправка русских/латинских букв.
    
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.


    5.2. Поле *«Месяц»*

    1) Отправка пустого поля.
    
        Ожидаемый результат: появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.

    2) Отправка нерелевантного значения - 00.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    3) Отправка нерелевантного значения (больше 12) - 25.
    
        Ожидаемый результат: появляется сообщение о неверном сроке действия карты, данные не отпавляются, записей в таблицах БД не создается.

    4) Отправка спец. символов.
        
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.

    5) Отправка русских/латинских букв.  
        
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.

    5.3. Поле *«Год»*

    1) Отправка пустого поля.
    
        Ожидаемый результат: появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    2) Отправка значения меньше нынешнего года.
        
        Ожидаемый результат: появляется сообщение об истекшем сроке действия карты, данные не отпавляются, записей в таблицах БД не создается.
    
    3) Отправка значения более чем на 10 превышающего нынешний год.
        
        Ожидаемый результат: появляется сообщение о неверном сроке действия карты, данные не отпавляются, записей в таблицах БД не создается
    
    4) Отправка значения менее 2 цифр.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    5) Отправка спец. символов.
        
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    6) Отправка русских/латинских букв.
        
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
   
    7) Отправка текущего года с прошедшим месяцем.
        
        Ожидаемый результат: появляется сообщение об истекшем сроке действия карты, данные не отпавляются, записей в таблицах БД не создается.

    5.4. Поле *«Владелец»*

    1) Отправка пустого поля.
    
        Ожидаемый результат: появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    2) Отправка одного слова латинскими буквами.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    3) Отправка трёх и более слов латинскими буквами.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    4) Отправка спец.символов.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    5) Отправка двух слов русскими бквами.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    6) Отправка чисел.

    5.5. Поле *«CVV»*

    1) Отправка пустого поля.
   
        Ожидаемый результат: появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    2) Отправка 1 цифры.
        
        Ожидаемый результат: появляется сообщение о неверном формате введенных данных, данные не отпавляются, записей в таблицах БД не создается.
    
    3) Отправка 4 цифр.
        
        Ожидаемый результат: в форме отображаются только первые три введенные цифры, появляется уведомление об успешной оплате, в таблицах БД появляются соответсвующие записи.
    
    4) Отправка спец.символов.
        
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.
    
    5) Отправка русских/латинских букв.
        
        Ожидаемый результат: значение не вводится в поле формы, появляется указание об обязательном заполнении поля, данные не отпавляются, записей в таблицах БД не создается.

### API-тесты

Данные тесты проверяют, что при попытке обратиться к приложению через API сервис отдаёт те же данные, что и при UI-тестах. Они проверяют данные карт (номер, статус) в БД код ответа при обращении к Payment Gate и Credit Gate.

1. При обращении к <http://localhost:8080/api/v1/pay> должны быть получены: код - 200 и карта c номером "4444 4444 4444 4441" отдает статус APPROVED.
2. При обращении к <http://localhost:8080/api/v1/pay> должны быть получены: код - 200 и карта с номером "4444 4444 4444 4442" отдает статус DECLINED.
3. При обращении к <http://localhost:8080/api/v1/credit> должны быть получены: код - 200 и карта c номером "4444 4444 4444 4441" отдает статус APPROVED.
4. При обращении к <http://localhost:8080/api/v1/credit> должны быть получены: код - 200 и карта с номером "4444 4444 4444 4442" отдает статус DECLINED.
5. При обращении к <http://localhost:8080/api/v1/pay> с невалидными полями должны быть получены: код - 400 и сообщение - "Bad Request".
6. При обращении к <http://localhost:8080/api/v1/credit> с невалидными полями должны быть получены: код - 400 и сообщение - "Bad Request".

## Перечень используемых инструментов


  **IntelliJ IDEA** - среда разработки программного обеспечения для написания кода

  **Java** (версия 11) - язык программирования для написания кода

  **Git** - система контроля версий, позволяет фиксировать изменения в коде, быстро "откатить" изменения назад, сохранять предыдущие версии.

  **Gradle** — система автоматической сборки.

  **JUnit-5** - один из самых популярных фреймфорков для модульного тестирования ПО.

  **Selenide** - фреймворк для автоматизированного тестирования веб-приложений.

  **Lombok** - плагин для автоматической генерации кода, позволяет сократить количество кода.

  **Docker** -  ПО для автоматизации развёртывания и управления приложениями. Нужен для развертывания СУБД MySQL и PostgreSQL, а также Node.js  

  **Allure** - фреймворк для создания отчётов автотестов

## Перечень и описание возможных рисков при автоматизации

* Сложности с настройкой Docker-compose.yml и SUT — возможные проблемы с БД, запуском SUT.
* Сложности с раздельным подключением тестов через БД MySQL и PostgreSQL.
* Сложность с поиском требуемых локаторов на странице.
* Неоднозначность требований, неполнота или недостаточная подробность документации.

## Интервальная оценка с учётом рисков (в часах)

* Подготовка к проведению тестирования — 16 часов
* Написание тестов — 96 часов
* Резерв времени на написание баг-репортов — 32 часа
* Подготовка отчёта о результатах прогона тестов — 24 часа
* Подготовка комплексного отчёта по всему процессу автоматизации тестирования — 16 часов

## План сдачи работ (когда будут авто-тесты, результаты их прогона и отчёт по автоматизации)

_Готовность авто-тестов_ – через 14 рабочих дней после согласования плана.

_Результаты тестов, баг-репорты_ – через 4 рабочих дня после прогона тестов.

_Отчёт по итогам автоматизации_ – через 3 рабочих дня после отчёта по результатам тестов и оформления баг-репортов.
